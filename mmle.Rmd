---
title: "R Notebook"
output: html_notebook
---

### load the c++ log-likelihood function
```{r}
require(Rcpp)
require(BH)
Sys.setenv(CXX="/usr/local/bin/g++")
Sys.setenv("PKG_CXXFLAGS"="-std=c++11")
sourceCpp('heston_svj_loglike.cpp')
```

### test the function
Benchmark from Matlab: -2484.01736459803 0.472533
```{r}
par = c(0.05, 2, 0.2, 0.25, -0.8, 0, 0, 0)
y = data.matrix(read.csv('YObs.csv', header = F))
start.time <- Sys.time()
loglike(par, y)
end.time <- Sys.time()
end.time - start.time
```

### use `nloptr` for mle 
```{r}
library(nloptr)
f <- function(p) {
    return(loglike(p, y))
}
opts <- list("algorithm"="NLOPT_LN_PRAXIS",
             "xtol_rel"=1.0e-5)
# set lower and upper bound
lb = c(0, 0, 0, 0, -1, 0, 0, 0)
ub = c(1, 5, 1, 1, 1, 0, 0, 0)
start.time <- Sys.time()
result = nloptr(x0 = c(0.1, 1, 0.1, 0.1, -0.5, 0, 0, 0), eval_f = f, 
       opts = opts, lb = lb, ub = ub)
end.time <- Sys.time()
end.time - start.time
```