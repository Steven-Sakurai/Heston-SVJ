
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(27936)
> 
> n = 50
> len = 1001
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> par = c(0.05, 3.9, 0.08, 0.3038, -0.6974, 3.2, -0.3551, 0.0967*0.0967)
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-6, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.99, 0, -1, 1e-8)
> ub = c(0.5, 100, 1, 1, 0.99, 10, 0, 1)
> 
> # run n paths
> converge.list = vector(mode="numeric", length = n)
> est.par.list = data.frame(mu = double(), kappa = double(), theta = double(), xi = double(), rho = double(), lambda = double(), mu_s = double(), sigma_s = double())
> i = 1
> while(i <= n) {
+     seed.list = sample(10000, 4)
+     y = SimSVJ(par, len, log(100), par[3], 1/252, seed.list[1], seed.list[2], seed.list[3], seed.list[4])
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est.res = as.numeric(result$solution)
+ 	conv.res = check.converge(f, result$solution)
+ 	write.table(est.res, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(conv.res, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     print(i)
+     print(Sys.time() - start)
+     print(est.res)
+     est.par.list[i, ] = as.numeric(est.res)
+     converge.list[i] = conv.res
+ 	i = i + 1
+ }
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 1
Time difference of 6.8983335 mins
[1]  0.0845196421  5.6705344830  0.0920580696  0.4295961482 -0.7688094217
[6]  3.8390813285 -0.3713445446  0.0075673727
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 2
Time difference of 6.1113083 mins
[1]  0.1783120150  4.2250034971  0.0745213610  0.1757761804 -0.9899999868
[6]  3.3282103162 -0.3491010944  0.0099196567
[1] FALSE
[1] FALSE
[1] FALSE
[1] FALSE
[1] FALSE
[1] FALSE
[1] FALSE
[1] FALSE
[1] 3
Time difference of 1.6019386 hours
[1]  0.160112267  5.788407980  0.079765482  0.375436454 -0.714726750
[6]  0.772793298 -0.317121546  0.013287367
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 4
Time difference of 5.8394275 mins
[1]  0.0326404223  4.3636029427  0.0849792510  0.3249663466 -0.7971999770
[6]  3.3193953243 -0.3545031675  0.0049270428
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 5
Time difference of 8.6272192 mins
[1]  0.050955557  4.300132006  0.096924066  0.296599079 -0.809618915
[6]  4.635084275 -0.380554916  0.013194346
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 6
Time difference of 6.0657636 mins
[1]  0.134599721  4.732158439  0.079667148  0.325191260 -0.557429361
[6]  3.651553458 -0.332867217  0.015978715
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 7
Time difference of 7.6729653 mins
[1] -0.0231619256  2.6414414961  0.0933070943  0.3344409716 -0.8217110274
[6]  2.0322763630 -0.3346632356  0.0031918761
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 8
Time difference of 5.9612781 mins
[1]  0.0191283765  3.3487002695  0.0941730785  0.2936615465 -0.9199690962
[6]  3.3227145264 -0.3659767754  0.0097849362
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 9
Time difference of 5.1258029 mins
[1]  0.176571864  2.358347560  0.077432358  0.274366740 -0.560638224
[6]  4.109723380 -0.359253816  0.011325705
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 10
Time difference of 6.2515707 mins
[1] -0.012277738  8.990949806  0.070781970  0.387276864 -0.650491325
[6]  4.113462561 -0.350534322  0.011945022
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 11
Time difference of 5.7333495 mins
[1] -0.0414883570  3.7296025267  0.0859070214  0.3537555467 -0.7723264188
[6]  3.0688790626 -0.3607726656  0.0093495733
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 12
Time difference of 6.0289414 mins
[1] -0.0079715353  5.0893941747  0.0948899753  0.3473929374 -0.6731115608
[6]  3.3201817610 -0.3664555370  0.0074826857
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 13
Time difference of 6.6660602 mins
[1]  0.1734867161  4.0730179179  0.0677398380  0.2614020736 -0.7763237685
[6]  5.4099415261 -0.3272890316  0.0068681943
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 14
Time difference of 6.3938452 mins
[1]  0.285477218  7.901658658  0.066031651  0.258487569 -0.638287287
[6]  4.620274201 -0.403569631  0.009136399
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 15
Time difference of 8.8784699 mins
[1]  0.0023326973  2.4716215084  0.0809751620  0.2467477855 -0.6731866810
[6]  3.5780269372 -0.3608942835  0.0026874555
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 16
Time difference of 8.2800263 mins
[1] -0.0356887362  9.6568124454  0.0870103396  0.5138514521 -0.5117157730
[6]  2.8079956759 -0.3339764547  0.0082780326
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 17
Time difference of 6.0409436 mins
[1]  0.1143251241  3.6834575042  0.0911559602  0.3512260369 -0.6139161604
[6]  3.0651759931 -0.3347189553  0.0082917511
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 18
Time difference of 7.644803 mins
[1]  0.0487300446  3.6614928197  0.0699404011  0.3489081500 -0.5167013094
[6]  3.5780440305 -0.3622250772  0.0044267362
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 19
Time difference of 7.6678355 mins
[1] -0.1603806605 12.1216464399  0.0875079250  0.4566881117 -0.4602925421
[6]  3.5781490592 -0.3598622675  0.0052318791
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 20
Time difference of 5.7995883 mins
[1] -0.1784553611  2.4017191312  0.0921569783  0.2929206720 -0.6453544765
[6]  3.8399625045 -0.3670905330  0.0077537279
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 21
Time difference of 5.5664376 mins
[1] -0.0955621572  3.7525266867  0.0884596133  0.3034049693 -0.9513085090
[6]  4.0977059462 -0.3667169833  0.0062979329
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 22
Time difference of 7.4278473 mins
[1] -0.1251310208 13.1136789525  0.0808837442  0.4894613428 -0.5375956886
[6]  4.8810466759 -0.3564149329  0.0060806071
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 23
Time difference of 6.8187031 mins
[1] -0.123965267  3.168707132  0.086392538  0.293133013 -0.924844611
[6]  3.326718841 -0.368289830  0.012029859
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 24
Time difference of 6.9795524 mins
[1] -0.0825553964  4.1758039600  0.0864120514  0.2701132757 -0.7441701949
[6]  4.0976738616 -0.3432905558  0.0049977776
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 25
Time difference of 7.6431109 mins
[1] -0.0835023078  5.3669467170  0.0905294502  0.3745463242 -0.6748277699
[6]  2.0322492810 -0.3876076292  0.0045381716
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 26
Time difference of 6.5130918 mins
[1]  0.135371421  2.540864484  0.074289877  0.294281979 -0.876211377
[6]  2.302230779 -0.336601236  0.012711426
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 27
Time difference of 7.1766661 mins
[1]  0.0239746762  7.6432516885  0.0786401451  0.4520381326 -0.8875772609
[6]  3.5857231710 -0.3576165703  0.0099306894
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 28
Time difference of 6.1202981 mins
[1] -0.0093238042  2.5451221161  0.0833756712  0.2589118408 -0.9532977026
[6]  3.8410771325 -0.3629033037  0.0102021970
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 29
Time difference of 9.8962968 mins
[1] -0.0070455783 10.9342150725  0.0703767397  0.5554015326 -0.8307091081
[6]  1.5243174252 -0.3391981118  0.0102751721
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 30
Time difference of 5.9100023 mins
[1] -0.095705392  6.093375556  0.088858896  0.290635326 -0.934242934
[6]  4.103281679 -0.377948985  0.010590287
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 31
Time difference of 5.131986 mins
[1]  0.1242301161  3.9347615832  0.0797694173  0.2830181334 -0.8735537695
[6]  2.0339124035 -0.3848708738  0.0096934064
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 32
Time difference of 6.0330679 mins
[1] -0.073479958  3.335386900  0.095791361  0.318322984 -0.852108719
[6]  5.304998006 -0.301070937  0.012159411
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 33
Time difference of 6.3447061 mins
[1]  0.095581486 16.109779602  0.076623854  0.498153829 -0.496687314
[6]  3.883639259 -0.311949271  0.012508000
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 34
Time difference of 8.1038484 mins
[1]  0.1962103162  4.9900593397  0.0652936197  0.2559315248 -0.7437120387
[6]  3.5781104461 -0.3741053868  0.0057574014
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 35
Time difference of 6.6636526 mins
[1]  0.101896832  3.028764384  0.075116265  0.317655175 -0.834430896
[6]  3.069348439 -0.336722059  0.010432059
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 36
Time difference of 7.101568 mins
[1]  0.1749219639  7.1531282187  0.0844135143  0.4792189796 -0.6184755066
[6]  3.5781716824 -0.4103220075  0.0074241137
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 37
Time difference of 7.9751163 mins
[1] -0.085014287  5.069709939  0.101524531  0.277202926 -0.966267661
[6]  3.676796413 -0.334974560  0.019746881
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 38
Time difference of 5.5787842 mins
[1]  0.082367074  2.694283303  0.071521430  0.227099224 -0.822510118
[6]  1.523781516 -0.360719316  0.010105127
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 39
Time difference of 7.8925164 mins
[1] -0.0124987343  4.3790137917  0.0756324949  0.2108064977 -0.4886620739
[6]  3.3190989986 -0.3553064933  0.0025008967
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 40
Time difference of 5.9053583 mins
[1]  0.104215642  3.901929704  0.065123592  0.308122574 -0.631193243
[6]  4.397502788 -0.340424671  0.015345923
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 41
Time difference of 5.656634 mins
[1]  0.089158405  3.128086953  0.070865683  0.220576827 -0.864225639
[6]  2.550179958 -0.382130650  0.012950939
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 42
Time difference of 5.7343885 mins
[1]  0.2207795427  2.4300287346  0.0804480495  0.2880294785 -0.6809808938
[6]  4.3617393129 -0.3702749271  0.0092446121
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 43
Time difference of 5.6309184 mins
[1]  0.191882129  9.705562478  0.053771468  0.409427593 -0.541535311
[6]  3.588660396 -0.361402445  0.013204068
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 44
Time difference of 5.4617918 mins
[1]  0.0118179053  4.8704730466  0.1022475790  0.3683710065 -0.3855404311
[6]  3.5780603865 -0.3916656809  0.0044946817
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 45
Time difference of 4.4565386 mins
[1]  0.1361960290  2.7841276611  0.0690037267  0.2300951829 -0.7500538235
[6]  3.5785990585 -0.3791025281  0.0072605068
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 46
Time difference of 6.4246038 mins
[1]  0.260981572  0.700411772  0.092053566  0.212425504 -0.989999983
[6]  3.607076387 -0.374150021  0.017987650
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 47
Time difference of 4.788838 mins
[1]  0.1134758957  4.5797214735  0.0735065830  0.2740236801 -0.9571220170
[6]  2.8028162306 -0.3426548623  0.0019100419
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 48
Time difference of 5.1668271 mins
[1]  0.0189639681  4.7972340945  0.0873042252  0.4000987367 -0.4692180372
[6]  4.0976721594 -0.3233158748  0.0043890208
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 49
Time difference of 10.4294 mins
[1] -0.0294437550  3.6469183023  0.0896028314  0.3065057748 -0.9899999968
[6]  3.8446714865 -0.2922552191  0.0062911358
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 50
Time difference of 5.6577992 mins
[1]  0.054567659  2.604223442  0.089965070  0.372651265 -0.739849270
[6]  2.803890785 -0.424155047  0.010904241
> 
> write.csv(file = "convResult.csv", converge.list)
> write.csv(file = "estResult.csv", est.par.list)
> 
> proc.time()
     user    system   elapsed 
25191.916     2.804 25221.599 
