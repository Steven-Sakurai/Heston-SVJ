
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(20700)
> 
> n = 50
> len = 1001
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> par = c(0.05, 3.9, 0.08, 0.3038, -0.6974, 3.2, -0.3551, 0.0967*0.0967)
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-6, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.99, 0, -1, 1e-8)
> ub = c(0.5, 100, 1, 1, 0.99, 10, 0, 1)
> 
> # run n paths
> converge.list = vector(mode="numeric", length = n)
> est.par.list = data.frame(mu = double(), kappa = double(), theta = double(), xi = double(), rho = double(), lambda = double(), mu_s = double(), sigma_s = double())
> i = 1
> while(i <= n) {
+     seed.list = sample(10000, 4)
+     y = SimSVJ(par, len, log(100), par[3], 1/252, seed.list[1], seed.list[2], seed.list[3], seed.list[4])
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est.res = as.numeric(result$solution)
+ 	conv.res = check.converge(f, result$solution)
+ 	write.table(est.res, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(conv.res, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     print(i)
+     print(Sys.time() - start)
+     print(est.res)
+     est.par.list[i, ] = as.numeric(est.res)
+     converge.list[i] = conv.res
+ 	i = i + 1
+ }
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 1
Time difference of 8.2445344 mins
[1] -0.0609394344  4.3757131771  0.0872524905  0.3630546580 -0.8919840695
[6]  3.5894542078 -0.2900314276  0.0063838769
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 2
Time difference of 7.7160045 mins
[1]  0.082510403  5.439418009  0.081806539  0.312549847 -0.900331582
[6]  1.017367640 -0.375519389  0.015066445
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 3
Time difference of 9.0444723 mins
[1]  0.1271115503  3.4064151358  0.0957880399  0.3564814898 -0.8813296279
[6]  2.0328528611 -0.4090272108  0.0093659478
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 4
Time difference of 6.8189041 mins
[1] -0.0361176682  8.4128726893  0.0820573903  0.3704216991 -0.6480822392
[6]  3.5780731600 -0.3691372486  0.0050971264
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 5
Time difference of 7.1694554 mins
[1] -0.052539029  3.453296797  0.075416540  0.261754168 -0.820045600
[6]  2.778387864 -0.319769832  0.013694354
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 6
Time difference of 5.2256098 mins
[1]  0.177338412  6.351093837  0.075523781  0.309277151 -0.846558058
[6]  2.899254199 -0.325431020  0.017093853
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 7
Time difference of 9.0082617 mins
[1] -0.1455971860  8.1082105775  0.0957892696  0.4425225848 -0.6295280163
[6]  3.5781735791 -0.3474282487  0.0045768914
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 8
Time difference of 7.3932042 mins
[1]  0.1366186489  4.6161090963  0.0849242355  0.3208284506 -0.7295279257
[6]  3.0607630225 -0.3927818765  0.0058581578
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 9
Time difference of 6.5755543 mins
[1] -0.058799316  8.983157458  0.087348211  0.343273755 -0.533390825
[6]  4.373059545 -0.363751875  0.011221559
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 10
Time difference of 9.720398 mins
[1] -0.0208253382  2.9328668418  0.0952221189  0.2843694517 -0.9899999985
[6]  4.0991688234 -0.3780535363  0.0086843297
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 11
Time difference of 5.5200914 mins
[1] -0.038266881  5.139177958  0.073590295  0.346091638 -0.645414130
[6]  4.100521535 -0.389255951  0.011250591
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 12
Time difference of 8.1585906 mins
[1]  0.010616329  1.548730926  0.079800830  0.217508323 -0.899191394
[6]  4.639247163 -0.390454341  0.012737871
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 13
Time difference of 9.0145175 mins
[1] -0.2248638614  3.7959770207  0.0808211595  0.2973419079 -0.7038607625
[6]  2.0322444632 -0.3657781082  0.0037377264
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 14
Time difference of 7.5624714 mins
[1]  0.2877169197  3.2007447643  0.0794826955  0.2385800540 -0.8402413398
[6]  2.5454056016 -0.3973866581  0.0053077364
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 15
Time difference of 8.3989311 mins
[1]  0.0337146679  8.5121417834  0.0702357519  0.4846473890 -0.7628295962
[6]  2.8029180407 -0.4395254872  0.0084102237
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 16
Time difference of 6.1739437 mins
[1]  0.088300260  8.469450605  0.082426284  0.397103662 -0.685529551
[6]  3.084173861 -0.338998837  0.011522629
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 17
Time difference of 8.1152193 mins
[1]  0.2040698351  2.6580797753  0.0918262088  0.3466249735 -0.8246070753
[6]  3.5784607448 -0.3951521273  0.0082153979
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 18
Time difference of 19.027369 mins
[1]  0.1094606008  1.5888005660  0.0922653422  0.1895295546 -0.9900000000
[6]  3.8384613928 -0.3706957188  0.0080583529
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 19
Time difference of 6.1684652 mins
[1]  0.1216763941  5.5220828254  0.0789225869  0.2980020109 -0.6402508348
[6]  2.3030710748 -0.3364354566  0.0079704697
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 20
Time difference of 5.9267829 mins
[1] -0.012063120  3.481276787  0.094565533  0.371359891 -0.678589538
[6]  4.107989771 -0.368883299  0.010151973
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 21
Time difference of 6.5447944 mins
[1] -0.0333717172 10.4273953687  0.0785993571  0.2631427555 -0.8821231843
[6]  3.0624893638 -0.3658223617  0.0086575109
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 22
Time difference of 6.9236242 mins
[1]  0.1064130913  2.6279805954  0.0863898099  0.2466706707 -0.9181816202
[6]  4.6205369828 -0.3574608988  0.0053144548
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 23
Time difference of 7.6167667 mins
[1] -0.093426808  7.142786685  0.077660997  0.389296884 -0.670789280
[6]  4.823832640 -0.343776872  0.028502982
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 24
Time difference of 7.6558644 mins
[1]  0.113364841  6.564396935  0.080562526  0.434348032 -0.439994372
[6]  2.552441500 -0.341904662  0.010350648
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 25
Time difference of 6.9813984 mins
[1] -0.0076354996  8.0543584493  0.0741962034  0.3960537628 -0.4604461400
[6]  2.9821426212 -0.2975429616  0.0081448407
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 26
Time difference of 10.437614 mins
[1]  0.173867094  2.243379329  0.074944220  0.320687759 -0.547599226
[6]  1.822232757 -0.406512698  0.037299987
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 27
Time difference of 7.4917176 mins
[1]  0.107995707  1.283959779  0.065705509  0.172075530 -0.597711993
[6]  4.443784475 -0.370243717  0.019860075
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 28
Time difference of 5.8243293 mins
[1]  0.065053497  4.574964284  0.078391282  0.412579466 -0.716391008
[6]  4.623098766 -0.370802261  0.010370246
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 29
Time difference of 7.3795022 mins
[1] -0.0149933666  2.9302236407  0.0840990458  0.2525076341 -0.9416130754
[6]  3.5850697160 -0.3808611247  0.0098563413
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 30
Time difference of 6.3598235 mins
[1] -0.1155999102  5.6894094965  0.0767316858  0.2277850821 -0.7365433845
[6]  3.0647488265 -0.3429868565  0.0087096437
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 31
Time difference of 9.1972883 mins
[1] -0.055307489  4.448452492  0.078837879  0.295291666 -0.879204480
[6]  3.321894739 -0.295411639  0.005647301
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 32
Time difference of 8.2026657 mins
[1]  0.0360502034  3.3144330485  0.0857904586  0.3720678056 -0.9504493412
[6]  2.0325914235 -0.3547523563  0.0066415744
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 33
Time difference of 6.3420577 mins
[1]  0.2358091113  6.7003560283  0.0643228403  0.3705122704 -0.8637225660
[6]  3.0608337061 -0.3510546789  0.0057798989
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 34
Time difference of 18.556646 mins
[1] -0.0765752558  0.5284307831  0.0811813893  0.1345258048 -0.9899999135
[6]  4.6206852039 -0.3447628029  0.0056908725
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 35
Time difference of 9.2466442 mins
[1]  0.023351211  2.771813136  0.082558478  0.131717943 -0.989999451
[6]  4.112829169 -0.354022520  0.009214730
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 36
Time difference of 7.8489751 mins
[1] -0.1928418139  6.7724017240  0.0849818696  0.3268719724 -0.7944943052
[6]  1.2663421793 -0.3775066277  0.0048412331
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 37
Time difference of 8.1275042 mins
[1]  0.00032058419  4.69839684213  0.09365618795  0.38243463919 -0.80497258515
[6]  3.06784957968 -0.38532627780  0.01155669280
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 38
Time difference of 14.550277 mins
[1] -0.1343381000  1.3024956518  0.1022152586  0.2359384247 -0.9631418788
[6]  3.5786172168 -0.4292673494  0.0098058286
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 39
Time difference of 16.703291 mins
[1]  0.3734957425  9.1008598139  0.0647352484  0.2234112071 -0.9899999919
[6]  1.5211007157 -0.3311651512  0.0025451286
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 40
Time difference of 6.2858099 mins
[1]  0.1284588784  5.2196856094  0.0856695315  0.4220518999 -0.7692744047
[6]  2.8028069946 -0.3627579636  0.0042984171
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 41
Time difference of 12.542832 mins
[1]  0.019745802  2.292674505  0.080910104  0.190629039 -0.989999990
[6]  2.295310160 -0.358899572  0.010974273
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 42
Time difference of 6.7792445 mins
[1]  0.0846367572  5.5249217400  0.0671827281  0.3363823450 -0.6732912241
[6]  3.8516753061 -0.2948412644  0.0080041815
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 43
Time difference of 6.6236357 mins
[1]  0.1043268299  4.6012398633  0.0759779460  0.3386035159 -0.6188474064
[6]  3.3192373125 -0.3759371428  0.0065713221
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 44
Time difference of 9.1540713 mins
[1]  0.0448572165 10.2789279446  0.1046835092  0.5531069771 -0.5638370628
[6]  2.5488763880 -0.2927639754  0.0017280534
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 45
Time difference of 11.577938 mins
[1]  0.067809930  3.989097242  0.068554287  0.154392997 -0.989999977
[6]  1.517881269 -0.278472471  0.030295163
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 46
Time difference of 4.1664385 mins
[1]  0.040601448  2.666770997  0.090062480  0.212612177 -0.656373696
[6]  3.584080817 -0.394416494  0.012577610
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 47
Time difference of 5.313443 mins
[1] -0.0096171455  1.7168750776  0.0828410682  0.1396874884 -0.9899931960
[6]  1.7889240905 -0.3263998313  0.0101796084
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 48
Time difference of 4.812307 mins
[1]  0.0330904183  7.4966990071  0.0959825575  0.4691485653 -0.8110310570
[6]  2.0344922451 -0.3759393554  0.0093132372
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 49
Time difference of 4.7824131 mins
[1]  0.1326231751  6.7081519343  0.0656694904  0.3301073108 -0.7570789229
[6]  1.7770773599 -0.3512079564  0.0067272214
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 50
Time difference of 3.9661574 mins
[1]  0.1658433182  7.4914446057  0.0751734537  0.3374062038 -0.8665118935
[6]  3.5866211580 -0.3601773165  0.0097848257
> 
> write.csv(file = "convResult.csv", converge.list)
> write.csv(file = "estResult.csv", est.par.list)
> 
> proc.time()
     user    system   elapsed 
24469.772     2.280 24561.562 
