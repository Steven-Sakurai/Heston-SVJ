
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(3962)
> 
> n = 50
> len = 1001
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> par = c(0.05, 3.9, 0.08, 0.3038, -0.6974, 3.2, -0.3551, 0.0967*0.0967)
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-6, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.99, 0, -1, 1e-8)
> ub = c(0.5, 100, 1, 1, 0.99, 10, 0, 1)
> 
> # run n paths
> converge.list = vector(mode="numeric", length = n)
> est.par.list = data.frame(mu = double(), kappa = double(), theta = double(), xi = double(), rho = double(), lambda = double(), mu_s = double(), sigma_s = double())
> i = 1
> while(i <= n) {
+     seed.list = sample(10000, 4)
+     y = SimSVJ(par, len, log(100), par[3], 1/252, seed.list[1], seed.list[2], seed.list[3], seed.list[4])
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est.res = as.numeric(result$solution)
+ 	conv.res = check.converge(f, result$solution)
+ 	write.table(est.res, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(conv.res, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     print(i)
+     print(Sys.time() - start)
+     print(est.res)
+     est.par.list[i, ] = as.numeric(est.res)
+     converge.list[i] = conv.res
+ 	i = i + 1
+ }
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 1
Time difference of 13.122655 mins
[1] -0.0814954281  5.1799071921  0.0738618018  0.1620256949 -0.9899999993
[6]  3.3192015557 -0.3786936997  0.0060894692
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 2
Time difference of 6.4021642 mins
[1] -0.081381972  4.962593189  0.116524831  0.429955760 -0.842384433
[6]  2.586900709 -0.413346324  0.024131335
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 3
Time difference of 6.7797671 mins
[1]  0.122050185 12.088098919  0.080312405  0.436613135 -0.512286601
[6]  3.612023864 -0.368163216  0.015737162
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 4
Time difference of 18.552487 mins
[1] -0.0136342469  1.1204917415  0.0917094692  0.1608299111 -0.9899999848
[6]  2.8051925572 -0.3475558955  0.0036020065
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 5
Time difference of 6.3172355 mins
[1] -0.166162694  2.457966830  0.092299054  0.282594576 -0.736261625
[6]  3.066331317 -0.364806042  0.010654007
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 6
Time difference of 8.6431403 mins
[1]  0.2496745994  2.7358355305  0.0566680981  0.2086658145 -0.9899999993
[6]  3.8400590533 -0.2822713408  0.0055782479
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 7
Time difference of 7.6578241 mins
[1]  0.1058224909  5.5073628380  0.0765349801  0.3738712677 -0.5910083404
[6]  3.3191082258 -0.3302127069  0.0028594553
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 8
Time difference of 8.2224884 mins
[1]  0.029741542 11.212977860  0.078859332  0.381310970 -0.728124413
[6]  3.583774677 -0.374667288  0.011884294
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 9
Time difference of 7.6880753 mins
[1] -0.0042117685  6.4135608053  0.0840735963  0.3608192621 -0.5106581061
[6]  3.3406721018 -0.4229004390  0.0193776185
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 10
Time difference of 6.7928265 mins
[1]  0.0846796703  5.2994111881  0.0897615264  0.2525606224 -0.4356500059
[6]  3.8431405440 -0.3476224955  0.0075848826
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 11
Time difference of 6.7804709 mins
[1] -0.1322566926  5.9685728184  0.0935922110  0.3324336212 -0.8664199689
[6]  3.8396269128 -0.3780455650  0.0078718291
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 12
Time difference of 7.9433443 mins
[1]  0.2255146219  2.0446027185  0.0772654410  0.2237973318 -0.9606501842
[6]  2.5482697081 -0.3529248843  0.0095183701
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 13
Time difference of 7.0187898 mins
[1] -0.2113692966  6.1977135321  0.0949526608  0.2150300509 -0.6022726423
[6]  2.5454873703 -0.3123514197  0.0031382376
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 14
Time difference of 7.7722337 mins
[1]  0.1846876151  4.5988593734  0.0749595291  0.3667883540 -0.4826355748
[6]  2.5454360912 -0.3973814078  0.0031094983
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 15
Time difference of 7.3250902 mins
[1]  0.079927667  9.553850795  0.078927889  0.490259327 -0.667116628
[6]  2.032836155 -0.344513918  0.013834605
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 16
Time difference of 6.7501983 mins
[1]  0.1222935605  3.4153351014  0.0767569824  0.2655676218 -0.8291439126
[6]  3.5793132850 -0.3729233893  0.0081922207
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 17
Time difference of 7.2792691 mins
[1] -0.060125944  5.763594324  0.093829350  0.396739586 -0.914071178
[6]  3.428535339 -0.320895218  0.027461509
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 18
Time difference of 7.4114303 mins
[1]  0.023082145  5.998966600  0.077728479  0.410119710 -0.696788149
[6]  2.814896941 -0.380763077  0.012278003
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 19
Time difference of 16.205228 mins
[1] -0.165302463  5.294786039  0.095500857  0.215659408 -0.989999896
[6]  2.912566901 -0.317266710  0.022307018
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 20
Time difference of 7.5760168 mins
[1]  0.254163155  6.280350576  0.077882568  0.368208175 -0.698399852
[6]  4.905655334 -0.327260877  0.007631713
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 21
Time difference of 6.158909 mins
[1] -0.2544841685 14.0610200962  0.0896935159  0.5733859592 -0.5150735863
[6]  3.8518728402 -0.3294254740  0.0087413265
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 22
Time difference of 7.3937156 mins
[1]  0.0029181229  6.6553717745  0.0800811711  0.3729435020 -0.7448335102
[6]  3.6065490723 -0.3184028842  0.0102150112
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 23
Time difference of 11.625215 mins
[1]  0.1527830746  6.4209908110  0.0738647372  0.3574295786 -0.0688553338
[6]  1.5211260387 -0.3668695124  0.0013870194
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 24
Time difference of 9.5779309 mins
[1] -0.1391497489 10.6916609849  0.0774295583  0.5159672636 -0.4345526977
[6]  2.8029610886 -0.3767996945  0.0067893835
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 25
Time difference of 8.7487616 mins
[1] -0.0573915715  2.6605189836  0.0896505663  0.2016369413 -0.9899999971
[6]  3.8387633371 -0.3538835204  0.0074181768
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 26
Time difference of 5.4461777 mins
[1]  0.2950657058  4.4224568226  0.0709252375  0.2274917817 -0.8515835633
[6]  4.3671707405 -0.3374445838  0.0098787044
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 27
Time difference of 4.6828868 mins
[1]  0.1273298957  5.9194541413  0.0754175098  0.2119840992 -0.9069611552
[6]  2.0331141126 -0.3489602911  0.0074239817
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 28
Time difference of 6.0908176 mins
[1] -0.039332717  2.845915295  0.070954910  0.172169214 -0.857306815
[6]  2.803451998 -0.336135340  0.006546735
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 29
Time difference of 6.6236532 mins
[1]  0.0849166898  6.7395707849  0.0811717821  0.4136495259 -0.7691641797
[6]  5.1437151726 -0.3688559855  0.0067566396
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 30
Time difference of 6.6623609 mins
[1]  0.1558756981  9.4901418313  0.0778071742  0.4906216592 -0.6387029565
[6]  2.0367905003 -0.2909613507  0.0061657009
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 31
Time difference of 5.0433032 mins
[1] -0.032121155  5.594529140  0.081295562  0.316906307 -0.634610874
[6]  3.602231771 -0.344906466  0.013819965
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 32
Time difference of 6.3459006 mins
[1]  0.0508230256  5.1799391427  0.0730878290  0.3953076260 -0.6752649662
[6]  2.0330985544 -0.2989340922  0.0052537466
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 33
Time difference of 6.641623 mins
[1]  0.226605766  3.986160834  0.082419172  0.290191263 -0.861625485
[6]  4.098014821 -0.350835481  0.005876988
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 34
Time difference of 7.0246328 mins
[1]  0.170464511 17.403418422  0.071119586  0.687566709 -0.685223685
[6]  3.847237539 -0.337386251  0.010749427
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 35
Time difference of 6.2412931 mins
[1] -0.0841128629  4.7827959634  0.0868594411  0.3835520661 -0.6774797740
[6]  3.8375714955 -0.3828115134  0.0059742683
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 36
Time difference of 6.8017531 mins
[1] -0.253852925  3.675619337  0.103166590  0.407954559 -0.645003142
[6]  2.881485938 -0.383804532  0.019710792
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 37
Time difference of 8.7919757 mins
[1] -0.0013016548  4.0946460961  0.0878029288  0.3367225558 -0.5641257120
[6]  4.3785595132 -0.3983997881  0.0141312263
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 38
Time difference of 8.1005059 mins
[1] -0.292466971  3.021734431  0.088929694  0.227688678 -0.989999995
[6]  3.468837596 -0.323112498  0.021158276
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 39
Time difference of 5.785411 mins
[1]  0.2692011093  1.8907499136  0.0789465934  0.2392482900 -0.7489358014
[6]  2.2887862647 -0.3584657188  0.0058820224
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 40
Time difference of 6.4026006 mins
[1]  0.1029924543  2.2894168886  0.0771351541  0.1977353970 -0.3480761878
[6]  3.0615608410 -0.3587673707  0.0068567463
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 41
Time difference of 6.187958 mins
[1] -0.068267873  6.369412926  0.081764429  0.321198557 -0.603145780
[6]  2.573915649 -0.333642816  0.012957486
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 42
Time difference of 6.8758794 mins
[1]  0.176139456  7.035871352  0.067022079  0.291644106 -0.690472195
[6]  4.103381828 -0.418233604  0.014661207
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 43
Time difference of 6.5505373 mins
[1] -0.083272588  3.990720178  0.093546567  0.367140887 -0.833092394
[6]  2.585051735 -0.313917351  0.012162316
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 44
Time difference of 6.8697032 mins
[1]  0.0484312126  6.9254449147  0.0827990913  0.4060686957 -0.8186176632
[6]  2.8031836512 -0.3586789060  0.0066326915
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 45
Time difference of 8.244262 mins
[1] -0.0122311216  8.7818093559  0.0772075439  0.4001749600 -0.7956004767
[6]  1.7763998429 -0.3255269480  0.0018602308
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 46
Time difference of 5.2879347 mins
[1] -0.3087023027  3.1725159798  0.0890194678  0.2991390309 -0.6820003530
[6]  3.5780588394 -0.3557550115  0.0042654379
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 47
Time difference of 6.4587457 mins
[1]  0.139003662  4.010331269  0.097308454  0.324395051 -0.730214005
[6]  2.805546583 -0.378504194  0.010413053
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 48
Time difference of 6.8233551 mins
[1] -0.1929710675  4.8701485874  0.0859400876  0.2434282237 -0.7143982361
[6]  2.2888008032 -0.3302969571  0.0043577226
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 49
Time difference of 6.5049511 mins
[1]  0.1065882553  5.9129701242  0.0622689485  0.3807613335 -0.9163952421
[6]  3.3191311518 -0.3837668067  0.0048590277
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 50
Time difference of 6.3766999 mins
[1]  0.1219690466  2.2050333936  0.0793614662  0.2301032667 -0.9899999915
[6]  2.5454932184 -0.4035420929  0.0045432502
> 
> write.csv(file = "convResult.csv", converge.list)
> write.csv(file = "estResult.csv", est.par.list)
> 
> proc.time()
     user    system   elapsed 
22710.444     2.300 22739.374 
