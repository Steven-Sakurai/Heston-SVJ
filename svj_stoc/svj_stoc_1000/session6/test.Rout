
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(8580)
> 
> n = 50
> len = 1001
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> par = c(0.05, 3.9, 0.08, 0.3038, -0.6974, 3.2, -0.3551, 0.0967*0.0967)
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-6, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.99, 0, -1, 1e-8)
> ub = c(0.5, 100, 1, 1, 0.99, 10, 0, 1)
> 
> # run n paths
> converge.list = vector(mode="numeric", length = n)
> est.par.list = data.frame(mu = double(), kappa = double(), theta = double(), xi = double(), rho = double(), lambda = double(), mu_s = double(), sigma_s = double())
> i = 1
> while(i <= n) {
+     seed.list = sample(10000, 4)
+     y = SimSVJ(par, len, log(100), par[3], 1/252, seed.list[1], seed.list[2], seed.list[3], seed.list[4])
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est.res = as.numeric(result$solution)
+ 	conv.res = check.converge(f, result$solution)
+ 	write.table(est.res, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(conv.res, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     print(i)
+     print(Sys.time() - start)
+     print(est.res)
+     est.par.list[i, ] = as.numeric(est.res)
+     converge.list[i] = conv.res
+ 	i = i + 1
+ }
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 1
Time difference of 8.0548199 mins
[1]  0.040382876  5.647141397  0.082998678  0.359825809 -0.798973909
[6]  5.484562790 -0.335511894  0.014986075
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 2
Time difference of 6.5421231 mins
[1] -0.166703071 10.465113174  0.097669742  0.387906770 -0.570656447
[6]  2.297080432 -0.352876173  0.011313795
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 3
Time difference of 6.2677632 mins
[1]  0.041672821  3.793587461  0.078789968  0.168476646 -0.851191420
[6]  3.062558298 -0.350345970  0.008116145
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 4
Time difference of 6.573641 mins
[1]  0.137511471  8.386967108  0.066920210  0.285612441 -0.647393556
[6]  3.326412818 -0.388788849  0.012585423
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 5
Time difference of 7.0914398 mins
[1] -0.0251953068  3.2051253601  0.0872281015  0.2976873261 -0.9838375580
[6]  2.5512541289 -0.3304253325  0.0063867696
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 6
Time difference of 7.2146758 mins
[1] -0.2050797242  4.0799681766  0.0839902912  0.3521235209 -0.6800448707
[6]  3.0745233174 -0.3292564551  0.0087298436
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 7
Time difference of 7.7206226 mins
[1] -0.147371195  5.617444807  0.085745118  0.245927988 -0.376418977
[6]  2.945942866 -0.353877586  0.029503848
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 8
Time difference of 9.4370412 mins
[1] -0.278125002  4.108852747  0.117646934  0.388807166 -0.677385244
[6]  2.288605654 -0.392086868  0.003740332
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 9
Time difference of 8.2735985 mins
[1] -0.0995280153  4.0752062963  0.0810966210  0.3911755737 -0.7423587487
[6]  3.3197507534 -0.3371122077  0.0062888489
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 10
Time difference of 6.953391 mins
[1]  0.0654261251  7.0012881455  0.0698563096  0.2496275021 -0.7659159344
[6]  2.5493030897 -0.3522599965  0.0096989513
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 11
Time difference of 15.518738 mins
[1] -0.050279032  3.066040911  0.088211931  0.212989331 -0.989999997
[6]  5.165578558 -0.358912083  0.010522362
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 12
Time difference of 6.8852382 mins
[1]  0.0865590513 10.5492131373  0.0877708890  0.4831740635 -0.2959942672
[6]  2.0360080220 -0.3486543609  0.0069688634
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 13
Time difference of 7.0940841 mins
[1]  0.039335726  5.106540107  0.075672193  0.244356014 -0.556053721
[6]  4.367833952 -0.370487690  0.010663225
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 14
Time difference of 6.2243124 mins
[1] -0.0553984542  5.7906490073  0.0846998910  0.4677469511 -0.6406081528
[6]  3.3259396462 -0.3524350713  0.0099066074
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 15
Time difference of 8.4274738 mins
[1]  0.0792607625  1.9186822078  0.0702219028  0.2079865500 -0.6507009397
[6]  2.8028035067 -0.3836640548  0.0037547623
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 16
Time difference of 6.8447097 mins
[1]  0.2162448144  5.4815187694  0.0667259981  0.4192867077 -0.5186823390
[6]  2.0322874785 -0.3555847591  0.0046881189
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 17
Time difference of 6.6870454 mins
[1]  0.0814745936  2.3236467019  0.0935373166  0.2529711257 -0.8328247041
[6]  3.3207458004 -0.3566091153  0.0065392631
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 18
Time difference of 6.1985519 mins
[1]  0.0930058009  3.4945291612  0.0718264726  0.2850442727 -0.5022613193
[6]  3.5796077810 -0.3684906391  0.0084696751
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 19
Time difference of 5.8341189 mins
[1]  0.2405963786  4.6053141530  0.0717513822  0.2762854535 -0.8205207988
[6]  4.8877716021 -0.3500256071  0.0078344028
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 20
Time difference of 13.377084 mins
[1]  0.280909274  1.633090177  0.065096335  0.144870712 -0.989999997
[6]  1.819394146 -0.156693858  0.027572866
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 21
Time difference of 7.3483898 mins
[1] -0.177795327  5.750491221  0.095481158  0.409111592 -0.492720680
[6]  3.069258498 -0.383899267  0.012899186
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 22
Time difference of 9.3924199 mins
[1] -0.0303134424  5.6366969421  0.0897362502  0.4168582422 -0.6614646850
[6]  3.0610259376 -0.3539803002  0.0048010243
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 23
Time difference of 13.367903 mins
[1] -0.161658674  4.596591861  0.066661305  0.245307240 -0.989999993
[6]  3.192725463 -0.365397247  0.037116898
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 24
Time difference of 7.5963232 mins
[1]  0.057939867  5.517006637  0.069449919  0.252386150 -0.548717948
[6]  4.696354780 -0.312265711  0.014692672
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 25
Time difference of 6.3555895 mins
[1] -0.084748615  4.231992498  0.091356310  0.211339911 -0.931183707
[6]  4.117645836 -0.375167837  0.015561900
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 26
Time difference of 7.046418 mins
[1]  0.214309510  3.245804968  0.072139043  0.333841882 -0.731930368
[6]  3.066942394 -0.384781911  0.011263280
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 27
Time difference of 11.570201 mins
[1]  0.0359119273  7.7562582367  0.0711363018  0.5441161925 -0.6919193057
[6]  1.2663462333 -0.3223044784  0.0037119724
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 28
Time difference of 8.2575489 mins
[1] -0.0115025028  3.7616411873  0.0767640198  0.1429337755 -0.4107356109
[6]  4.0987646911 -0.3566193345  0.0074604431
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 29
Time difference of 9.1374484 mins
[1] -0.0288101387  9.0358519408  0.0653365220  0.3635372837 -0.5548685678
[6]  4.0974976786 -0.3332137872  0.0034846539
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 30
Time difference of 8.2700658 mins
[1]  0.0719777554  8.2584722579  0.1006591279  0.4506797026 -0.8709110662
[6]  3.8375269573 -0.4141858832  0.0062301066
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 31
Time difference of 5.9110043 mins
[1] -0.0524196655  3.6144408001  0.0883005446  0.3817959058 -0.6399915015
[6]  2.8148429460 -0.3264976501  0.0082872224
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 32
Time difference of 6.744184 mins
[1]  0.1489391435  3.1660400087  0.0683036348  0.1805168246 -0.8604272589
[6]  3.8376651507 -0.3574412884  0.0053235684
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 33
Time difference of 6.206502 mins
[1] -0.228992798  5.787289915  0.082954976  0.321672446 -0.707984908
[6]  4.064480306 -0.334363353  0.015698028
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 34
Time difference of 6.203179 mins
[1]  0.026049664  4.342954184  0.086310701  0.310879793 -0.378066847
[6]  3.898059989 -0.384014336  0.018267906
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 35
Time difference of 6.7859356 mins
[1] -0.1373346479  4.5915912931  0.0922741094  0.3890133368 -0.5975258835
[6]  2.0362125423 -0.3222902512  0.0079236022
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 36
Time difference of 8.676558 mins
[1]  0.182173015  7.884850928  0.057407756  0.358884096 -0.619688210
[6]  4.097476393 -0.409703581  0.003912289
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 37
Time difference of 7.690046 mins
[1]  0.023733627  2.078795323  0.074891533  0.259009027 -0.989999452
[6]  2.608074387 -0.415647254  0.028840259
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 38
Time difference of 6.7809113 mins
[1] -0.0719466252  4.8555553761  0.0839940620  0.3738230509 -0.8859717902
[6]  4.1054618030 -0.3139671126  0.0073073006
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 39
Time difference of 13.091839 mins
[1] -0.234973204 20.064845235  0.092974664  0.364665657 -0.989999991
[6]  3.069119257 -0.297579278  0.005160835
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 40
Time difference of 6.2892259 mins
[1]  0.1598413964  2.2765134788  0.0851600980  0.2017225212 -0.9216697446
[6]  1.2663073054 -0.3510146072  0.0041646744
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 41
Time difference of 8.2192275 mins
[1]  0.0152371480  4.5603266905  0.0836033719  0.3671147008 -0.6228080721
[6]  3.0606865778 -0.3601183721  0.0032552669
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 42
Time difference of 6.5668959 mins
[1] -0.1503229626  1.7674065646  0.1040763629  0.2906683267 -0.6796692564
[6]  4.6215352249 -0.3807712576  0.0089612273
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 43
Time difference of 6.8887066 mins
[1]  0.0063039310  5.3005813993  0.0788589613  0.3245903681 -0.4384476704
[6]  2.5468333420 -0.3276327127  0.0064670349
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 44
Time difference of 8.5157902 mins
[1]  0.2937894823  5.1888707302  0.0642768081  0.2728231707 -0.5605024285
[6]  1.2664382271 -0.3319097501  0.0051584261
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 45
Time difference of 6.823864 mins
[1]  0.0021546395  7.4396014093  0.0846283540  0.4163221221 -0.7102194863
[6]  2.2905755459 -0.3570183861  0.0088020957
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 46
Time difference of 7.0544692 mins
[1] -0.0040544369  3.0554933619  0.0702560059  0.1916071198 -0.8121436480
[6]  3.0699457054 -0.3521855577  0.0098847854
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 47
Time difference of 3.514884 mins
[1]  0.1190743452  1.0418553436  0.0700554619  0.1465844555 -0.9900000000
[6]  3.0675255745 -0.3433198419  0.0087038152
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 48
Time difference of 5.9711982 mins
[1] -0.0971661115  4.8445127830  0.0820470230  0.3772616596 -0.8272381064
[6]  3.3192492700 -0.3681256529  0.0055497545
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 49
Time difference of 5.0532435 mins
[1]  0.0382035871  3.4349342612  0.0748078790  0.3390968872 -0.3966996874
[6]  3.3198913378 -0.3545190593  0.0058934214
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] FALSE
[1] TRUE
[1] TRUE
[1] TRUE
[1] 50
Time difference of 11.175642 mins
[1] -0.0723813947  3.2030290400  0.0942602866  0.2475022786 -0.9899999991
[6]  2.5494691435 -0.3563876741  0.0096468376
> 
> write.csv(file = "convResult.csv", converge.list)
> write.csv(file = "estResult.csv", est.par.list)
> 
> proc.time()
     user    system   elapsed 
23315.736     2.824 23407.007 
